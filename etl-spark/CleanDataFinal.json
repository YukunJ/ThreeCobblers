{"paragraphs":[{"text":"%livy2.pyspark\n\n# read the data\ndf = spark.read.json('wasb://datasets@clouddeveloper.blob.core.windows.net/twitter-dataset/')","user":"anonymous","dateUpdated":"2022-03-23T19:38:26+0000","config":{"tableHide":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1647702102282_0011<br/>Spark WebUI: <a href=\"http://hn1-ccgrou.bb3uqjcfo4oelpessztkgc52je.bx.internal.cloudapp.net:8088/proxy/application_1647702102282_0011/\">http://hn1-ccgrou.bb3uqjcfo4oelpessztkgc52je.bx.internal.cloudapp.net:8088/proxy/application_1647702102282_0011/</a>"}]},"apps":[],"jobName":"paragraph_1648064306110_1284630656","id":"20220316-205615_1017501044","dateCreated":"2022-03-23T19:38:26+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3529"},{"text":"%livy2.pyspark\nimport locale\nlocale.setlocale(locale.LC_ALL,'en_US.UTF-8'); # set the encoding for Lower() functionality","user":"anonymous","dateUpdated":"2022-03-23T19:38:26+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"'en_US.UTF-8'"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1647702102282_0011<br/>Spark WebUI: <a href=\"http://hn1-ccgrou.bb3uqjcfo4oelpessztkgc52je.bx.internal.cloudapp.net:8088/proxy/application_1647702102282_0011/\">http://hn1-ccgrou.bb3uqjcfo4oelpessztkgc52je.bx.internal.cloudapp.net:8088/proxy/application_1647702102282_0011/</a>"}]},"apps":[],"jobName":"paragraph_1648064306112_2053124713","id":"20220319-170312_1591383673","dateCreated":"2022-03-23T19:38:26+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3530"},{"text":"%livy2.pyspark\nfrom pyspark.sql.functions import isnull\n\n#filter out entries in which both id and id_str are null\ndf_filter_id = df.filter(~(isnull(df.id) & isnull(df.id_str)))\n\n#filter out entries in which user is null\ndf_filter_user = df_filter_id.filter(~isnull(df_filter_id.user))\n\n#filter out entries in which created_at is null\ndf_filter_created_at = df_filter_user.filter(~isnull(df_filter_user.created_at))\n\n#filter out entries in which text is null\ndf_filter_text = df_filter_created_at.filter(~isnull(df_filter_created_at.text))\n\ndf_filter_text.count()","user":"anonymous","dateUpdated":"2022-03-23T19:38:26+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"297920006"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1647702102282_0011<br/>Spark WebUI: <a href=\"http://hn1-ccgrou.bb3uqjcfo4oelpessztkgc52je.bx.internal.cloudapp.net:8088/proxy/application_1647702102282_0011/\">http://hn1-ccgrou.bb3uqjcfo4oelpessztkgc52je.bx.internal.cloudapp.net:8088/proxy/application_1647702102282_0011/</a>"}]},"apps":[],"jobName":"paragraph_1648064306112_903421712","id":"20220319-151311_768935374","dateCreated":"2022-03-23T19:38:26+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3531"},{"text":"%livy2.pyspark\nfrom pyspark.sql.functions import length\n#filter out entries in which text is empty\ndf_filter_text_nonempty = df_filter_text.filter(length(\"text\") > 0)\n\n#filter out entries in which entities is null\ndf_filter_entities = df_filter_text_nonempty.filter(~isnull(df_filter_text_nonempty.entities))\n\n#get user.id\ndf_user_id = df_filter_entities.withColumn(\"user_id\", df_filter_entities.user[\"id\"])\n\n#get user.id_str\ndf_user_id_str = df_user_id.withColumn(\"user_id_str\", df_user_id.user[\"id_str\"])\n\n#filter out entries in which both user_id and user_id_str are null\ndf_filter_user_id_str = df_user_id_str.filter(~(isnull(df_user_id_str.user_id) & isnull(df_user_id_str.user_id_str)))","user":"anonymous","dateUpdated":"2022-03-23T19:38:26+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1647702102282_0011<br/>Spark WebUI: <a href=\"http://hn1-ccgrou.bb3uqjcfo4oelpessztkgc52je.bx.internal.cloudapp.net:8088/proxy/application_1647702102282_0011/\">http://hn1-ccgrou.bb3uqjcfo4oelpessztkgc52je.bx.internal.cloudapp.net:8088/proxy/application_1647702102282_0011/</a>"}]},"apps":[],"jobName":"paragraph_1648064306113_1678882572","id":"20220319-151340_1908509822","dateCreated":"2022-03-23T19:38:26+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3532"},{"text":"%livy2.pyspark\n\n#add the column hashtags\ndf_hashtags = df_filter_user_id_str.withColumn(\"hashtags\", df_filter_user_id_str.entities[\"hashtags\"])\n\n#filter out enntries in which hashtags is null\ndf_filter_hashtags = df_hashtags.filter(~isnull(df_hashtags.hashtags))\n\n#filter out enntries in which hashtags is empty array\nfrom pyspark.sql.functions import size\ndf_filter_hashtags_nonempty = df_filter_hashtags.filter(size(\"hashtags\") > 0)","user":"anonymous","dateUpdated":"2022-03-23T19:38:26+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1647702102282_0011<br/>Spark WebUI: <a href=\"http://hn1-ccgrou.bb3uqjcfo4oelpessztkgc52je.bx.internal.cloudapp.net:8088/proxy/application_1647702102282_0011/\">http://hn1-ccgrou.bb3uqjcfo4oelpessztkgc52je.bx.internal.cloudapp.net:8088/proxy/application_1647702102282_0011/</a>"}]},"apps":[],"jobName":"paragraph_1648064306113_1239525898","id":"20220319-151405_1786729142","dateCreated":"2022-03-23T19:38:26+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3533"},{"text":"%livy2.pyspark\n#filter out entries in which lang is null\ndf_filter_lang = df_filter_hashtags_nonempty.filter(~isnull(df_filter_hashtags_nonempty.lang))\n\n# filter the language\ndf_filter_lang_eight = df_filter_lang.filter(((df_filter_lang.lang == \"ar\") | (df_filter_lang.lang == \"en\") | (df_filter_lang.lang == \"fr\") | (df_filter_lang.lang == \"in\") | (df_filter_lang.lang == \"pt\") | (df_filter_lang.lang == \"es\") | (df_filter_lang.lang == \"tr\") | (df_filter_lang.lang == \"ja\")))\n\n#remove duplicate\ndf_drop_duplicate = df_filter_lang_eight.dropDuplicates(['id'])","user":"anonymous","dateUpdated":"2022-03-23T19:38:26+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1647702102282_0011<br/>Spark WebUI: <a href=\"http://hn1-ccgrou.bb3uqjcfo4oelpessztkgc52je.bx.internal.cloudapp.net:8088/proxy/application_1647702102282_0011/\">http://hn1-ccgrou.bb3uqjcfo4oelpessztkgc52je.bx.internal.cloudapp.net:8088/proxy/application_1647702102282_0011/</a>"}]},"apps":[],"jobName":"paragraph_1648064306114_6848990","id":"20220319-151429_270734524","dateCreated":"2022-03-23T19:38:26+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3534"},{"text":"%livy2.pyspark\ndf_drop_duplicate.count()","user":"anonymous","dateUpdated":"2022-03-23T19:38:26+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"39192534"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1647702102282_0011<br/>Spark WebUI: <a href=\"http://hn1-ccgrou.bb3uqjcfo4oelpessztkgc52je.bx.internal.cloudapp.net:8088/proxy/application_1647702102282_0011/\">http://hn1-ccgrou.bb3uqjcfo4oelpessztkgc52je.bx.internal.cloudapp.net:8088/proxy/application_1647702102282_0011/</a>"}]},"apps":[],"jobName":"paragraph_1648064306114_-1794373113","id":"20220318-034509_490630599","dateCreated":"2022-03-23T19:38:26+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3535"},{"text":"%livy2.pyspark\ndf_drop_duplicate.columns","user":"anonymous","dateUpdated":"2022-03-23T19:38:26+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['contributors', 'coordinates', 'created_at', 'delete', 'display_text_range', 'entities', 'extended_entities', 'extended_tweet', 'favorite_count', 'favorited', 'filter_level', 'geo', 'id', 'id_str', 'in_reply_to_screen_name', 'in_reply_to_status_id', 'in_reply_to_status_id_str', 'in_reply_to_user_id', 'in_reply_to_user_id_str', 'is_quote_status', 'lang', 'place', 'possibly_sensitive', 'quoted_status', 'quoted_status_id', 'quoted_status_id_str', 'retweet_count', 'retweeted', 'retweeted_status', 'scopes', 'source', 'status_withheld', 'text', 'timestamp_ms', 'truncated', 'user', 'withheld_copyright', 'withheld_in_countries', 'user_id', 'user_id_str', 'hashtags']"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1647702102282_0011<br/>Spark WebUI: <a href=\"http://hn1-ccgrou.bb3uqjcfo4oelpessztkgc52je.bx.internal.cloudapp.net:8088/proxy/application_1647702102282_0011/\">http://hn1-ccgrou.bb3uqjcfo4oelpessztkgc52je.bx.internal.cloudapp.net:8088/proxy/application_1647702102282_0011/</a>"}]},"apps":[],"jobName":"paragraph_1648064306115_142523099","id":"20220319-172120_696392646","dateCreated":"2022-03-23T19:38:26+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3536"},{"text":"%livy2.pyspark\ndf.columns","user":"anonymous","dateUpdated":"2022-03-23T19:38:26+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['contributors', 'coordinates', 'created_at', 'delete', 'display_text_range', 'entities', 'extended_entities', 'extended_tweet', 'favorite_count', 'favorited', 'filter_level', 'geo', 'id', 'id_str', 'in_reply_to_screen_name', 'in_reply_to_status_id', 'in_reply_to_status_id_str', 'in_reply_to_user_id', 'in_reply_to_user_id_str', 'is_quote_status', 'lang', 'place', 'possibly_sensitive', 'quoted_status', 'quoted_status_id', 'quoted_status_id_str', 'retweet_count', 'retweeted', 'retweeted_status', 'scopes', 'source', 'status_withheld', 'text', 'timestamp_ms', 'truncated', 'user', 'withheld_copyright', 'withheld_in_countries']"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1647702102282_0011<br/>Spark WebUI: <a href=\"http://hn1-ccgrou.bb3uqjcfo4oelpessztkgc52je.bx.internal.cloudapp.net:8088/proxy/application_1647702102282_0011/\">http://hn1-ccgrou.bb3uqjcfo4oelpessztkgc52je.bx.internal.cloudapp.net:8088/proxy/application_1647702102282_0011/</a>"}]},"apps":[],"jobName":"paragraph_1648064306116_-98347070","id":"20220319-172130_1788859940","dateCreated":"2022-03-23T19:38:26+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3537"},{"text":"%livy2.pyspark\ndf_final = df_drop_duplicate[df.columns]","user":"anonymous","dateUpdated":"2022-03-23T19:38:26+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1647702102282_0011<br/>Spark WebUI: <a href=\"http://hn1-ccgrou.bb3uqjcfo4oelpessztkgc52je.bx.internal.cloudapp.net:8088/proxy/application_1647702102282_0011/\">http://hn1-ccgrou.bb3uqjcfo4oelpessztkgc52je.bx.internal.cloudapp.net:8088/proxy/application_1647702102282_0011/</a>"}]},"apps":[],"jobName":"paragraph_1648064306116_-1997778153","id":"20220319-172137_12247298","dateCreated":"2022-03-23T19:38:26+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3538"},{"text":"%livy2.pyspark\ndf_final.count()","user":"anonymous","dateUpdated":"2022-03-23T19:38:26+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"39192534"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1647702102282_0011<br/>Spark WebUI: <a href=\"http://hn1-ccgrou.bb3uqjcfo4oelpessztkgc52je.bx.internal.cloudapp.net:8088/proxy/application_1647702102282_0011/\">http://hn1-ccgrou.bb3uqjcfo4oelpessztkgc52je.bx.internal.cloudapp.net:8088/proxy/application_1647702102282_0011/</a>"}]},"apps":[],"jobName":"paragraph_1648064306117_-2021719085","id":"20220319-172202_1306119720","dateCreated":"2022-03-23T19:38:26+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3539"},{"text":"%livy2.pyspark\ndf_final.write.json('cleanData.json')","user":"anonymous","dateUpdated":"2022-03-23T19:38:26+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1647702102282_0011<br/>Spark WebUI: <a href=\"http://hn1-ccgrou.bb3uqjcfo4oelpessztkgc52je.bx.internal.cloudapp.net:8088/proxy/application_1647702102282_0011/\">http://hn1-ccgrou.bb3uqjcfo4oelpessztkgc52je.bx.internal.cloudapp.net:8088/proxy/application_1647702102282_0011/</a>"}]},"apps":[],"jobName":"paragraph_1648064306117_1778855791","id":"20220319-152930_853459137","dateCreated":"2022-03-23T19:38:26+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3540"},{"text":"%livy2.pyspark\nref = spark.read.json(\"wasb://ccgroupproject-2022-03-19t14-47-33-853z@ccgroupprojechdistorage.blob.core.windows.net/user/livy/cleanData.json\")","user":"anonymous","dateUpdated":"2022-03-23T19:38:26+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1647702102282_0011<br/>Spark WebUI: <a href=\"http://hn1-ccgrou.bb3uqjcfo4oelpessztkgc52je.bx.internal.cloudapp.net:8088/proxy/application_1647702102282_0011/\">http://hn1-ccgrou.bb3uqjcfo4oelpessztkgc52je.bx.internal.cloudapp.net:8088/proxy/application_1647702102282_0011/</a>"}]},"apps":[],"jobName":"paragraph_1648064306119_-177712608","id":"20220319-153257_210842471","dateCreated":"2022-03-23T19:38:26+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3543"},{"text":"%livy2.pyspark\nref.count()","user":"anonymous","dateUpdated":"2022-03-23T19:38:26+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"39192534"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1647702102282_0011<br/>Spark WebUI: <a href=\"http://hn1-ccgrou.bb3uqjcfo4oelpessztkgc52je.bx.internal.cloudapp.net:8088/proxy/application_1647702102282_0011/\">http://hn1-ccgrou.bb3uqjcfo4oelpessztkgc52je.bx.internal.cloudapp.net:8088/proxy/application_1647702102282_0011/</a>"}]},"apps":[],"jobName":"paragraph_1648064306119_-400015960","id":"20220319-173948_1531891690","dateCreated":"2022-03-23T19:38:26+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3544"}],"name":"CleanDataNew","id":"2H1G63X9X","noteParams":{},"noteForms":{},"angularObjects":{"livy2:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}