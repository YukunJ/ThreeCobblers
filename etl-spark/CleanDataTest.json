{"paragraphs":[{"text":"%livy2.pyspark\n\n# read the data\ndf = spark.read.json('wasb://datasets@clouddeveloper.blob.core.windows.net/twitter-dataset/part-r-00000.gz')","user":"anonymous","dateUpdated":"2022-03-23T19:27:44+0000","config":{"tableHide":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1648063267097_0004<br/>Spark WebUI: <a href=\"http://hn1-threec.alobx0swy5iefpvuaexpxfxx1c.bx.internal.cloudapp.net:8088/proxy/application_1648063267097_0004/\">http://hn1-threec.alobx0swy5iefpvuaexpxfxx1c.bx.internal.cloudapp.net:8088/proxy/application_1648063267097_0004/</a>"}]},"apps":[],"jobName":"paragraph_1648063628530_-663001942","id":"20220316-205615_1017501044","dateCreated":"2022-03-23T19:27:08+0000","dateStarted":"2022-03-23T19:27:45+0000","dateFinished":"2022-03-23T19:29:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1995"},{"text":"%livy2.pyspark\nfrom pyspark.sql.functions import isnull\n\n#filter out entries in which both id and id_str are null\ndf_filter_id = df.filter(~(isnull(df.id) & isnull(df.id_str)))\n\n#filter out entries in which user is null\ndf_filter_user = df_filter_id.filter(~isnull(df_filter_id.user))\n\n#filter out entries in which created_at is null\ndf_filter_created_at = df_filter_user.filter(~isnull(df_filter_user.created_at))\n\n#filter out entries in which text is null\ndf_filter_text = df_filter_created_at.filter(~isnull(df_filter_created_at.text))","user":"anonymous","dateUpdated":"2022-03-23T19:27:48+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1648063267097_0004<br/>Spark WebUI: <a href=\"http://hn1-threec.alobx0swy5iefpvuaexpxfxx1c.bx.internal.cloudapp.net:8088/proxy/application_1648063267097_0004/\">http://hn1-threec.alobx0swy5iefpvuaexpxfxx1c.bx.internal.cloudapp.net:8088/proxy/application_1648063267097_0004/</a>"}]},"apps":[],"jobName":"paragraph_1648063628539_1108902122","id":"20220319-151311_768935374","dateCreated":"2022-03-23T19:27:08+0000","dateStarted":"2022-03-23T19:29:25+0000","dateFinished":"2022-03-23T19:29:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1996"},{"text":"%livy2.pyspark\n#check to see if the filtering process is successful\ndf_filter_text.filter((isnull(df_filter_text.id) & isnull(df_filter_text.id_str)) | isnull(df_filter_text.user) | isnull(df_filter_text.created_at) | isnull(df_filter_text.text)).count()","user":"anonymous","dateUpdated":"2022-03-23T19:31:08+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"0"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1648063267097_0004<br/>Spark WebUI: <a href=\"http://hn1-threec.alobx0swy5iefpvuaexpxfxx1c.bx.internal.cloudapp.net:8088/proxy/application_1648063267097_0004/\">http://hn1-threec.alobx0swy5iefpvuaexpxfxx1c.bx.internal.cloudapp.net:8088/proxy/application_1648063267097_0004/</a>"}]},"apps":[],"jobName":"paragraph_1648063669799_1620298160","id":"20220323-192749_225554672","dateCreated":"2022-03-23T19:27:49+0000","dateStarted":"2022-03-23T19:30:27+0000","dateFinished":"2022-03-23T19:30:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1997"},{"text":"%livy2.pyspark\nfrom pyspark.sql.functions import length\n#filter out entries in which text is empty\ndf_filter_text_nonempty = df_filter_text.filter(length(\"text\") > 0)\n\n#filter out entries in which entities is null\ndf_filter_entities = df_filter_text_nonempty.filter(~isnull(df_filter_text_nonempty.entities))\n\n#get user.id\ndf_user_id = df_filter_entities.withColumn(\"user_id\", df_filter_entities.user[\"id\"])\n\n#get user.id_str\ndf_user_id_str = df_user_id.withColumn(\"user_id_str\", df_user_id.user[\"id_str\"])\n\n#filter out entries in which both user_id and user_id_str are null\ndf_filter_user_id_str = df_user_id_str.filter(~(isnull(df_user_id_str.user_id) & isnull(df_user_id_str.user_id_str)))","user":"anonymous","dateUpdated":"2022-03-23T19:31:11+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1648063267097_0004<br/>Spark WebUI: <a href=\"http://hn1-threec.alobx0swy5iefpvuaexpxfxx1c.bx.internal.cloudapp.net:8088/proxy/application_1648063267097_0004/\">http://hn1-threec.alobx0swy5iefpvuaexpxfxx1c.bx.internal.cloudapp.net:8088/proxy/application_1648063267097_0004/</a>"}]},"apps":[],"jobName":"paragraph_1648063628540_-1702318381","id":"20220319-151340_1908509822","dateCreated":"2022-03-23T19:27:08+0000","dateStarted":"2022-03-23T19:31:11+0000","dateFinished":"2022-03-23T19:31:12+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1998"},{"text":"%livy2.pyspark\n#number of tweets containing empty text\ndf_filter_user_id_str.filter(length(\"text\") == 0).count()","user":"anonymous","dateUpdated":"2022-03-23T19:32:31+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"0"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1648063267097_0004<br/>Spark WebUI: <a href=\"http://hn1-threec.alobx0swy5iefpvuaexpxfxx1c.bx.internal.cloudapp.net:8088/proxy/application_1648063267097_0004/\">http://hn1-threec.alobx0swy5iefpvuaexpxfxx1c.bx.internal.cloudapp.net:8088/proxy/application_1648063267097_0004/</a>"}]},"apps":[],"jobName":"paragraph_1648063874259_-902445225","id":"20220323-193114_64050008","dateCreated":"2022-03-23T19:31:14+0000","dateStarted":"2022-03-23T19:32:31+0000","dateFinished":"2022-03-23T19:33:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1999"},{"text":"%livy2.pyspark\n#number of tweets containing null user.id and user.id_str\ndf_filter_user_id_str.filter((isnull(df_filter_user_id_str.user_id) & isnull(df_filter_user_id_str.user_id_str))).count()","user":"anonymous","dateUpdated":"2022-03-23T19:33:38+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"0"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1648063267097_0004<br/>Spark WebUI: <a href=\"http://hn1-threec.alobx0swy5iefpvuaexpxfxx1c.bx.internal.cloudapp.net:8088/proxy/application_1648063267097_0004/\">http://hn1-threec.alobx0swy5iefpvuaexpxfxx1c.bx.internal.cloudapp.net:8088/proxy/application_1648063267097_0004/</a>"}]},"apps":[],"jobName":"paragraph_1648063957017_1608980196","id":"20220323-193237_1536690868","dateCreated":"2022-03-23T19:32:37+0000","dateStarted":"2022-03-23T19:33:38+0000","dateFinished":"2022-03-23T19:34:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2000"},{"text":"%livy2.pyspark\n\n#add the column hashtags\ndf_hashtags = df_filter_user_id_str.withColumn(\"hashtags\", df_filter_user_id_str.entities[\"hashtags\"])\n\n#filter out enntries in which hashtags is null\ndf_filter_hashtags = df_hashtags.filter(~isnull(df_hashtags.hashtags))\n\n#filter out enntries in which hashtags is empty array\nfrom pyspark.sql.functions import size\ndf_filter_hashtags_nonempty = df_filter_hashtags.filter(size(\"hashtags\") > 0)","user":"anonymous","dateUpdated":"2022-03-23T19:35:45+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1648063267097_0004<br/>Spark WebUI: <a href=\"http://hn1-threec.alobx0swy5iefpvuaexpxfxx1c.bx.internal.cloudapp.net:8088/proxy/application_1648063267097_0004/\">http://hn1-threec.alobx0swy5iefpvuaexpxfxx1c.bx.internal.cloudapp.net:8088/proxy/application_1648063267097_0004/</a>"}]},"apps":[],"jobName":"paragraph_1648063628541_624831238","id":"20220319-151405_1786729142","dateCreated":"2022-03-23T19:27:08+0000","dateStarted":"2022-03-23T19:35:45+0000","dateFinished":"2022-03-23T19:35:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2001"},{"text":"%livy2.pyspark\n#number of tweets with null hashtags\ndf_filter_hashtags_nonempty.filter(isnull(df_filter_hashtags_nonempty.hashtags)).count()","user":"anonymous","dateUpdated":"2022-03-23T19:35:48+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"0"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1648063267097_0004<br/>Spark WebUI: <a href=\"http://hn1-threec.alobx0swy5iefpvuaexpxfxx1c.bx.internal.cloudapp.net:8088/proxy/application_1648063267097_0004/\">http://hn1-threec.alobx0swy5iefpvuaexpxfxx1c.bx.internal.cloudapp.net:8088/proxy/application_1648063267097_0004/</a>"}]},"apps":[],"jobName":"paragraph_1648064078099_1507664","id":"20220323-193438_912902389","dateCreated":"2022-03-23T19:34:38+0000","dateStarted":"2022-03-23T19:35:48+0000","dateFinished":"2022-03-23T19:36:12+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2002"},{"text":"%livy2.pyspark\n#number of tweets with no hashtags\ndf_filter_hashtags_nonempty.filter(size(\"hashtags\") == 0).count()","user":"anonymous","dateUpdated":"2022-03-23T19:36:42+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"0"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1648063267097_0004<br/>Spark WebUI: <a href=\"http://hn1-threec.alobx0swy5iefpvuaexpxfxx1c.bx.internal.cloudapp.net:8088/proxy/application_1648063267097_0004/\">http://hn1-threec.alobx0swy5iefpvuaexpxfxx1c.bx.internal.cloudapp.net:8088/proxy/application_1648063267097_0004/</a>"}]},"apps":[],"jobName":"paragraph_1648064151279_591858385","id":"20220323-193551_1582306156","dateCreated":"2022-03-23T19:35:51+0000","dateStarted":"2022-03-23T19:36:42+0000","dateFinished":"2022-03-23T19:37:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2003"},{"text":"%livy2.pyspark\n#filter out entries in which lang is null\ndf_filter_lang = df_filter_hashtags_nonempty.filter(~isnull(df_filter_hashtags_nonempty.lang))\n\n# filter the language\ndf_filter_lang_eight = df_filter_lang.filter(((df_filter_lang.lang == \"ar\") | (df_filter_lang.lang == \"en\") | (df_filter_lang.lang == \"fr\") | (df_filter_lang.lang == \"in\") | (df_filter_lang.lang == \"pt\") | (df_filter_lang.lang == \"es\") | (df_filter_lang.lang == \"tr\") | (df_filter_lang.lang == \"ja\")))\n\n#remove duplicate\ndf_drop_duplicate = df_filter_lang_eight.dropDuplicates(['id'])","user":"anonymous","dateUpdated":"2022-03-23T19:37:07+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1648063267097_0004<br/>Spark WebUI: <a href=\"http://hn1-threec.alobx0swy5iefpvuaexpxfxx1c.bx.internal.cloudapp.net:8088/proxy/application_1648063267097_0004/\">http://hn1-threec.alobx0swy5iefpvuaexpxfxx1c.bx.internal.cloudapp.net:8088/proxy/application_1648063267097_0004/</a>"}]},"apps":[],"jobName":"paragraph_1648063628542_2040334730","id":"20220319-151429_270734524","dateCreated":"2022-03-23T19:27:08+0000","dateStarted":"2022-03-23T19:37:08+0000","dateFinished":"2022-03-23T19:37:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2004"},{"text":"%livy2.pyspark\ndf_drop_duplicate.count()","user":"anonymous","dateUpdated":"2022-03-23T19:37:10+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"39092"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1648063267097_0004<br/>Spark WebUI: <a href=\"http://hn1-threec.alobx0swy5iefpvuaexpxfxx1c.bx.internal.cloudapp.net:8088/proxy/application_1648063267097_0004/\">http://hn1-threec.alobx0swy5iefpvuaexpxfxx1c.bx.internal.cloudapp.net:8088/proxy/application_1648063267097_0004/</a>"}]},"apps":[],"jobName":"paragraph_1648063628543_-1005445651","id":"20220318-034509_490630599","dateCreated":"2022-03-23T19:27:08+0000","dateStarted":"2022-03-23T19:37:10+0000","dateFinished":"2022-03-23T19:37:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2005"},{"text":"%livy2.pyspark\nref_df = spark.read.json(\"microservice3_ref.txt\")","user":"anonymous","dateUpdated":"2022-03-23T19:27:08+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1647559609009_0014<br/>Spark WebUI: <a href=\"http://hn1-groupp.vanalmw1zv5ebp4rihnis4f3xf.bx.internal.cloudapp.net:8088/proxy/application_1647559609009_0014/\">http://hn1-groupp.vanalmw1zv5ebp4rihnis4f3xf.bx.internal.cloudapp.net:8088/proxy/application_1647559609009_0014/</a>"}]},"apps":[],"jobName":"paragraph_1648063628546_1234735432","id":"20220316-232317_117277545","dateCreated":"2022-03-23T19:27:08+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2006"},{"text":"%livy2.pyspark\nref_df.count()","user":"anonymous","dateUpdated":"2022-03-23T19:27:08+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"39092"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1647559609009_0014<br/>Spark WebUI: <a href=\"http://hn1-groupp.vanalmw1zv5ebp4rihnis4f3xf.bx.internal.cloudapp.net:8088/proxy/application_1647559609009_0014/\">http://hn1-groupp.vanalmw1zv5ebp4rihnis4f3xf.bx.internal.cloudapp.net:8088/proxy/application_1647559609009_0014/</a>"}]},"apps":[],"jobName":"paragraph_1648063628547_-1147284696","id":"20220316-232724_266232123","dateCreated":"2022-03-23T19:27:08+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2007"}],"name":"CleanDataTest","id":"2GZ59JRMZ","noteParams":{},"noteForms":{},"angularObjects":{"livy2:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}